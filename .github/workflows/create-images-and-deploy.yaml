name: Create docker images and deploy
run-name: Create docker images and deploy
on: push
env:
  IP: ${{ vars.TUOTANTO_IP }}
  KAYTTAJA: ${{ vars.TUOTANTO_KAYTTAJA }}
  REPON_SIJAINTI: ${{ vars.TUOTANTO_KANSIO }}
jobs:
  create-images-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - run: ssh $KAYTTAJA@$IP "cd $REPON_SIJAINTI; git pull"
      - run: ssh $KAYTTAJA@$IP "./rakenna.sh -b huttustutka-back -f huttustutka-front"
      - run: ssh $KAYTTAJA@$IP "./aja.sh -b huttustutka-back -f huttustutka-front"
      - run: ssh $KAYTTAJA@$IP "docker image prune -a -f"
